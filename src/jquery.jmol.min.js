/*
 * jMol - jQuery Plugin
 * Complete replacement for Jmol.js
 * 
 * Copyright (c) 2012 Gusts 'gusC' Kaksis
 * 
 * Version: 1.0.0 alpha (10/07/2012)
 * Requires: jQuery v1.4+
 *
 * Licensed under the MIT license:
 *   http://www.opensource.org/licenses/mit-license.php
 */

var JmolCallbackWrapper=function(a){var b=function(b){a("#"+b)._jmol_cb("ready",arguments)},c=function(b){a("#"+b)._jmol_cb("echo",arguments)},d=function(b){a("#"+b)._jmol_cb("hover",arguments)},e=function(b){a("#"+b)._jmol_cb("load",arguments)},f=function(b){a("#"+b)._jmol_cb("measure",arguments)},g=function(b){a("#"+b)._jmol_cb("message",arguments)},h=function(b){a("#"+b)._jmol_cb("pick",arguments)},i=function(b){a("#"+b)._jmol_cb("script",arguments)},j=function(b){return a("#"+b)._jmol_cb("sync",arguments)};return{cbReady:b,cbEcho:c,cbHover:d,cbLoad:e,cbMeasure:f,cbMessage:g,cbPick:h,cbScript:i,cbSync:j}}(jQuery);(function(a){var b=function(){var b={appletUrl:"",appletFile:"JmolApplet0.jar",syncId:0,memLimit:512,width:400,height:300,menuUrl:"jmol.mnu",modelUrl:"",background:"#000000",onReady:function(a){},onDestroy:function(a){},onEcho:function(a){},onHover:function(a,b){},onLoad:function(a,b,c,d,e,f,g){},onMeasure:function(a){},onMessage:function(a){},onPick:function(a){},onScript:function(a){},onSync:function(a){return 1}},c='<object type="application/x-java-applet" id="%id%" name="%name%" class="jmol-viewer%class%" width="%width%" height="%height%"%add_params%>'+'<param name="syncId" value="%sync_id%"/>'+'<param name="progressbar" value="true">'+'<param name="progresscolor" value="blue">'+'<param name="boxbgcolor" value="%bg_color%"/>'+'<param name="boxfgcolor" value="black">'+'<param name="boxmessage" value="Downloading JmolApplet ...">'+'<param name="mayscript" value="true">'+'<param name="code" value="JmolApplet" />'+'<param name="codebase" value="%applet_url%" />'+'<param name="archive" value="%applet_file%" />'+'<param name="java_arguments" value="%java_args%"/>'+'<param name="script" value="%script%"/>'+'<param name="appletReadyCallback" value="JmolCallbackWrapper.cbReady" />'+'<param name="echoCallback" value="JmolCallbackWrapper.cbEcho" />'+'<param name="hoverCallback" value="JmolCallbackWrapper.cbHover" />'+'<param name="loadStructCallback" value="JmolCallbackWrapper.cbLoad" />'+'<param name="measureCallback" value="JmolCallbackWrapper.cbMeasure" />'+'<param name="messageCallback" value="JmolCallbackWrapper.cbMessage" />'+'<param name="pickCallback" value="JmolCallbackWrapper.cbPick" />'+'<param name="scriptCallback" value="JmolCallbackWrapper.cbScript" />'+'<param name="syncCallback" value="JmolCallbackWrapper.cbSync" />'+'<p style="background-color:yellow; color:black; width:400px;height:400px;text-align:center;vertical-align:middle;">'+"You do not have Java applets enabled in your web browser, or your browser is blocking this applet.<br>"+"Check the warning message from your browser and/or enable Java applets in<br>"+'your web browser preferences, or install the Java Runtime Environment from <a href="http://www.java.com">www.java.com</a><br></p>'+"</object>",d="clsid:8AD9C840-044E-11D1-B3E9-00805F499D93",e="http://java.sun.com/update/1.6.0/jinstall-6u22-windows-i586.cab",f=0,g={};var h=function(c){var d={};if(typeof c=="object"){d=a.extend({},b,c||{})}else if(typeof c=="undefined"){d=a.extend({},b,{});c=d}var e=this;this.each(function(b,e){var h=a(e);if(h.is(".jmol-viewer")){if(typeof c=="string"){var i=h.attr("id");var k=document.getElementById(i);if(typeof k.script=="function"){k.script(c)}else{var l=a("<div></div>");h.replaceWith(l);l.replaceWith(h);l=null;k.script(c)}k=null}else if(typeof c=="object"){console.log("jMol option update not implemented")}}else if(typeof c=="object"){f++;var i=h.attr("id");var m=h.attr("class");if(typeof i=="undefined"){i="jmolApplet"+f}if(typeof m=="undefined"){m=""}else{m=" "+m}if(d["syncId"]<=0){d["syncId"]=f}$applet=j(i,m,d);h.replaceWith($applet);h=null;h=$applet;g[i]=d;$applet=null}else{console.log("Error in initializing jMol")}});return e},i=function(a,b){var c=g[b[0]];switch(a){case"ready":if(b[2]){c.onReady(b[1])}else{c.onDestroy(b[1])}break;case"echo":c.onEcho(b[1]);break;case"hover":c.onHover(b[1],b[2]);break;case"load":c.onLoad(b[1],b[2],b[3],b[4],b[5],b[6],b[7]);break;case"measure":c.onMeasure(b[1]);break;case"message":c.onMessage(b[1]);break;case"pick":var d=b[1].split(" ");var e={id:d[0],num:d[1],coords:{x:parseFloat(d[2]),y:parseFloat(d[3]),z:parseFloat(d[4])}};c.onPick(e);break;case"script":c.onScript(b[1]);break}console.log(a,b)},j=function(b,f,g){var h="";if(a.browser.msie){h=' classid="'+d+'" codebase="'+e+'"'}var i="";if(g["menuUrl"].length>0){i+="load MENU "+g["menuUrl"]+";"}if(g["modelUrl"].length>0){i+="load "+g["modelUrl"]+";"}var j=c.replace("%add_params%",h);j=j.replace("%sync_id%",g["syncId"]);j=j.replace("%id%",b);j=j.replace("%name%",b);j=j.replace("%class%",f);j=j.replace("%width%",g["width"]);j=j.replace("%height%",g["height"]);j=j.replace("%applet_url%",g["appletUrl"]);j=j.replace("%applet_file%",g["appletFile"]);j=j.replace("%java_args%","-Xmx"+g["memLimit"]+"m");j=j.replace("%bg_color%",g["background"]);j=j.replace("%script%",i);return a(j)};return{proc:h,callback:i}}();a.fn.extend({jmol:b.proc,_jmol_cb:b.callback})})(jQuery)
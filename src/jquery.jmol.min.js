/*
 * jMol - jQuery Plugin
 * Complete replacement for Jmol.js
 * 
 * Copyright (c) 2012 Gusts 'gusC' Kaksis
 * 
 * Version: 1.0.0 alpha (10/07/2012)
 * Requires: jQuery v1.4+
 *
 * Licensed under the MIT license:
 *   http://www.opensource.org/licenses/mit-license.php
 */

var JmolCallbackWrapper=(function(e){var c=function(k){e("#"+k)._jmol_cb("ready",arguments)},i=function(k){e("#"+k)._jmol_cb("echo",arguments)},a=function(k){e("#"+k)._jmol_cb("hover",arguments)},g=function(k){e("#"+k)._jmol_cb("load",arguments)},j=function(k){e("#"+k)._jmol_cb("measure",arguments)},h=function(k){e("#"+k)._jmol_cb("message",arguments)},b=function(k){e("#"+k)._jmol_cb("pick",arguments)},f=function(k){e("#"+k)._jmol_cb("script",arguments)},d=function(k){return e("#"+k)._jmol_cb("sync",arguments)};return{cbReady:c,cbEcho:i,cbHover:a,cbLoad:g,cbMeasure:j,cbMessage:h,cbPick:b,cbScript:f,cbSync:d}})(jQuery);(function(b){var a=(function(){var i={appletUrl:"",appletFile:"JmolApplet0.jar",syncId:0,memLimit:512,width:400,height:300,menuUrl:"jmol.mnu",modelUrl:"",background:"#000000",onReady:function(l){},onDestroy:function(l){},onEcho:function(l){},onHover:function(m,l){},onLoad:function(m,r,l,q,n,p,o){},onMeasure:function(l){},onMessage:function(l){},onPick:function(l){},onScript:function(l){},onSync:function(l){return 1},},j='<object type="application/x-java-applet" id="%id%" name="%name%" class="jmol%class%" width="%width%" height="%height%"%add_params%><param name="syncId" value="%sync_id%"/><param name="progressbar" value="true"><param name="progresscolor" value="blue"><param name="boxbgcolor" value="%bg_color%"/><param name="boxfgcolor" value="black"><param name="boxmessage" value="Downloading JmolApplet ..."><param name="mayscript" value="true"><param name="code" value="JmolApplet" /><param name="codebase" value="%applet_url%" /><param name="archive" value="%applet_file%" /><param name="java_arguments" value="%java_args%"/><param name="script" value="%script%"/><param name="appletReadyCallback" value="JmolCallbackWrapper.cbReady" /><param name="echoCallback" value="JmolCallbackWrapper.cbEcho" /><param name="hoverCallback" value="JmolCallbackWrapper.cbHover" /><param name="loadStructCallback" value="JmolCallbackWrapper.cbLoad" /><param name="measureCallback" value="JmolCallbackWrapper.cbMeasure" /><param name="messageCallback" value="JmolCallbackWrapper.cbMessage" /><param name="pickCallback" value="JmolCallbackWrapper.cbPick" /><param name="scriptCallback" value="JmolCallbackWrapper.cbScript" /><p style="background-color:yellow; color:black; width:400px;height:400px;text-align:center;vertical-align:middle;">You do not have Java applets enabled in your web browser, or your browser is blocking this applet.<br>Check the warning message from your browser and/or enable Java applets in<br>your web browser preferences, or install the Java Runtime Environment from <a href="http://www.java.com">www.java.com</a><br></p></object>',f="clsid:8AD9C840-044E-11D1-B3E9-00805F499D93",g="http://java.sun.com/update/1.6.0/jinstall-6u22-windows-i586.cab",e=0,d={};var h=function(n){var m={};if(typeof n=="object"){m=b.extend({},i,n||{})}else{if(typeof n=="undefined"){m=b.extend({},i,{});n=m}}var l=this;this.each(function(r,s){var q=b(s);if(q.is(".jmol")){if(typeof n=="string"){var t=q.get(0);t.script(n)}else{if(typeof n=="object"){console.log("jMol option update not implemented")}}}else{if(typeof n=="object"){e++;var u=q.attr("id");var p=q.attr("class");if(typeof u=="undefined"){u="jmolApplet"+e}if(typeof p=="undefined"){p=""}else{p=" "+p}if(m.syncId<=0){m.syncId=e}$applet=c(u,p,m);q.replaceWith($applet);q=$applet;d[u]=m}else{console.log("Error in initializing jMol")}}});return l},k=function(o,n){var m=d[n[0]];switch(o){case"ready":if(n[2]){m.onReady(n[1])}else{m.onDestroy(n[1])}break;case"echo":m.onEcho(n[1]);break;case"hover":m.onHover(n[1],n[2]);break;case"load":m.onLoad(n[1],n[2],n[3],n[4],n[5],n[6],n[7]);break;case"measure":m.onMeasure(n[1]);break;case"message":m.onMessage(n[1]);break;case"pick":var l=n[1].split(" ");var p={id:l[0],num:l[1],coords:{x:l[2],y:l[3],z:l[4]}};m.onPick(p);break;case"script":m.onScript(n[1]);break}console.log(o,n)},c=function(q,l,n){var p="";if(b.browser.msie){p=' classid="'+f+'" codebase="'+g+'"'}var m="";if(n.menuUrl.length>0){m+="load MENU "+n.menuUrl+";"}if(n.modelUrl.length>0){m+="load "+n.modelUrl+";"}var o=j.replace("%add_params%",p);o=o.replace("%sync_id%",n.syncId);o=o.replace("%id%",q);o=o.replace("%name%",q);o=o.replace("%class%",l);o=o.replace("%width%",n.width);o=o.replace("%height%",n.height);o=o.replace("%applet_url%",n.appletUrl);o=o.replace("%applet_file%",n.appletFile);o=o.replace("%java_args%","-Xmx"+n.memLimit+"m");o=o.replace("%bg_color%",n.background);o=o.replace("%script%",m);return b(o)};return{proc:h,callback:k}})();b.fn.extend({jmol:a.proc,_jmol_cb:a.callback})})(jQuery);